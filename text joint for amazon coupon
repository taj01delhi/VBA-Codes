Sub GenerateTextJoins()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(1) ' Modify if using a different sheet

    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.count, 1).End(xlUp).Row ' Finds last row in Column A

    Dim batchSize As Long: batchSize = 2900
    Dim outputRow As Long: outputRow = 1
    Dim result As String
    Dim count As Long: count = 0
    Dim i As Long

    For i = 1 To lastRow
        Dim asin As String
        asin = Trim(ws.Cells(i, 1).Value)
        
        ' Skip if ASIN is blank
        If asin <> "" Then
            result = result & asin & ";"
            count = count + 1
        End If

        ' When batchSize reached, write to output
        If count = batchSize Then
            ws.Cells(outputRow, 2).Value = Left(result, Len(result) - 1) ' Remove last semicolon
            outputRow = outputRow + 1
            result = ""
            count = 0
        End If
    Next i

    ' Write remaining if any left
    If count > 0 Then
        ws.Cells(outputRow, 2).Value = Left(result, Len(result) - 1)
    End If

    MsgBox "TEXTJOIN done. Check Column B.", vbInformation
End Sub

